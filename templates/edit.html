{% extends "base.html" %}

{% block title %}Edit HTML File{% endblock %}

{% block content %}
<div class="editor-container">
    <!-- Header Section -->
    <div class="editor-header">
        <div class="editor-title">
            <div class="file-icon">
                <i class="fas fa-file-code"></i>
            </div>
            <div class="file-info">
                <h1>{{ original_name }}</h1>
                <span class="file-path">{{ filename }}</span>
            </div>
        </div>
        <div class="editor-actions">
            <button type="button" class="btn btn-outline-secondary" id="togglePreview">
                <i class="fas fa-eye"></i> Split View
            </button>
            <a href="{{ url_for('serve_file', filename=filename) }}" target="_blank" class="btn btn-outline-primary">
                <i class="fas fa-external-link-alt"></i> Open in New Tab
            </a>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Dashboard
            </a>
        </div>
    </div>

    <!-- Editor Content -->
    <div class="editor-content">
        <div class="editor-sidebar">
            <div class="sidebar-section">
                <h3><i class="fas fa-tools"></i> Tools</h3>
                <div class="tool-buttons">
                    <button type="button" class="tool-btn" id="formatCode" title="Format HTML">
                        <i class="fas fa-magic"></i> Format
                    </button>
                    <button type="button" class="tool-btn" id="validateCode" title="Validate HTML">
                        <i class="fas fa-check-circle"></i> Validate
                    </button>
                    <button type="button" class="tool-btn" id="findReplace" title="Find & Replace">
                        <i class="fas fa-search"></i> Find
                    </button>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-info-circle"></i> File Info</h3>
                <div class="file-stats">
                    <div class="stat-item">
                        <span class="stat-label">Lines:</span>
                        <span class="stat-value" id="lineCount">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Characters:</span>
                        <span class="stat-value" id="charCount">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Size:</span>
                        <span class="stat-value" id="fileSize">0 KB</span>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i class="fas fa-shield-alt"></i> Security</h3>
                <div class="security-info">
                    <div class="security-badge">
                        <i class="fas fa-lock"></i>
                        <span>Owner Only</span>
                    </div>
                    <p class="security-text">Only you can edit this file. Others can view but not modify.</p>
                </div>
            </div>
        </div>

        <div class="editor-main">
            <div class="editor-tabs">
                <div class="tab active" data-tab="editor">
                    <i class="fas fa-code"></i> Editor
                </div>
                <div class="tab" data-tab="preview" id="previewTab">
                    <i class="fas fa-eye"></i> Preview
                </div>
            </div>

            <div class="editor-workspace">
                <div class="editor-panel active" id="editorPanel">
                    <form id="editForm">
                        <input type="hidden" name="filename" value="{{ filename }}">

                        <!-- Find & Replace Panel -->
                        <div class="find-replace-panel" id="findReplacePanel">
                            <div class="find-replace-controls">
                                <div class="input-group">
                                    <input type="text" id="findInput" placeholder="Find..." class="form-control">
                                    <input type="text" id="replaceInput" placeholder="Replace..." class="form-control">
                                </div>
                                <div class="find-buttons">
                                    <button type="button" class="btn btn-sm btn-outline-primary"
                                        id="findNext">Next</button>
                                    <button type="button" class="btn btn-sm btn-outline-primary"
                                        id="findPrev">Prev</button>
                                    <button type="button" class="btn btn-sm btn-outline-success"
                                        id="replaceOne">Replace</button>
                                    <button type="button" class="btn btn-sm btn-outline-success"
                                        id="replaceAll">All</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"
                                        id="closeFindReplace">Ã—</button>
                                </div>
                            </div>
                        </div>

                        <div class="code-editor-wrapper">
                            <div class="line-numbers" id="lineNumbers"></div>
                            <textarea class="code-editor" id="content" name="content"
                                placeholder="Enter your HTML code here...">{{ content }}</textarea>
                        </div>
                    </form>
                </div>

                <div class="editor-panel" id="previewPanel">
                    <div class="preview-container">
                        <iframe id="previewFrame" src="about:blank"></iframe>
                    </div>
                </div>
            </div>

            <!-- Action Bar -->
            <div class="action-bar">
                <div class="action-left">
                    <div class="save-status" id="saveStatus">
                        <i class="fas fa-circle text-success"></i>
                        <span>All changes saved</span>
                    </div>
                </div>
                <div class="action-right">
                    <button type="button" class="btn btn-outline-warning" onclick="resetContent()">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                    <button type="submit" form="editForm" class="btn btn-success" id="saveBtn">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Messages -->
    <div id="statusMessage" class="status-toast"></div>
</div>

<script>
    // Store original content for reset functionality
    const originalContent = {{ content| tojson }};
    let isUnsaved = false;
    let currentSearchIndex = -1;
    let searchMatches = [];

    // Initialize editor
    document.addEventListener('DOMContentLoaded', function () {
        updateStats();
        updateLineNumbers();
        updatePreview();

        // Auto-save every 30 seconds if there are unsaved changes
        setInterval(autoSave, 30000);
    });

    // Update file statistics
    function updateStats() {
        const content = document.getElementById('content').value;
        const lines = content.split('\n').length;
        const chars = content.length;
        const size = (new Blob([content]).size / 1024).toFixed(2);

        document.getElementById('lineCount').textContent = lines;
        document.getElementById('charCount').textContent = chars;
        document.getElementById('fileSize').textContent = size + ' KB';
    }

    // Update line numbers
    function updateLineNumbers() {
        const content = document.getElementById('content');
        const lineNumbers = document.getElementById('lineNumbers');
        const lines = content.value.split('\n').length;

        let lineNumbersHtml = '';
        for (let i = 1; i <= lines; i++) {
            lineNumbersHtml += `<div class="line-number">${i}</div>`;
        }
        lineNumbers.innerHTML = lineNumbersHtml;
    }

    // Update preview
    function updatePreview() {
        const content = document.getElementById('content').value;
        const previewFrame = document.getElementById('previewFrame');
        const blob = new Blob([content], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        previewFrame.src = url;
    }

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function () {
            const tabName = this.dataset.tab;

            // Update active tab
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            // Update active panel
            document.querySelectorAll('.editor-panel').forEach(p => p.classList.remove('active'));
            document.getElementById(tabName + 'Panel').classList.add('active');

            if (tabName === 'preview') {
                updatePreview();
            }
        });
    });

    // Split view toggle
    document.getElementById('togglePreview').addEventListener('click', function () {
        const workspace = document.querySelector('.editor-workspace');
        workspace.classList.toggle('split-view');

        if (workspace.classList.contains('split-view')) {
            this.innerHTML = '<i class="fas fa-code"></i> Code Only';
            document.getElementById('previewPanel').classList.add('active');
            updatePreview();
        } else {
            this.innerHTML = '<i class="fas fa-eye"></i> Split View';
            document.getElementById('previewPanel').classList.remove('active');
        }
    });

    // Content change handler
    document.getElementById('content').addEventListener('input', function () {
        updateStats();
        updateLineNumbers();
        markUnsaved();

        // Debounced preview update
        clearTimeout(this.previewTimeout);
        this.previewTimeout = setTimeout(updatePreview, 500);
    });

    // Mark as unsaved
    function markUnsaved() {
        isUnsaved = true;
        const saveStatus = document.getElementById('saveStatus');
        saveStatus.innerHTML = '<i class="fas fa-circle text-warning"></i><span>Unsaved changes</span>';
    }

    // Mark as saved
    function markSaved() {
        isUnsaved = false;
        const saveStatus = document.getElementById('saveStatus');
        saveStatus.innerHTML = '<i class="fas fa-circle text-success"></i><span>All changes saved</span>';
    }

    // Auto-save function
    function autoSave() {
        if (isUnsaved) {
            saveFile(true);
        }
    }

    // Reset content
    function resetContent() {
        if (confirm('Are you sure you want to reset all changes? This will restore the original content.')) {
            document.getElementById('content').value = originalContent;
            updateStats();
            updateLineNumbers();
            updatePreview();
            markSaved();
        }
    }

    // Format HTML code
    document.getElementById('formatCode').addEventListener('click', function () {
        const content = document.getElementById('content');
        try {
            // Simple HTML formatting
            let formatted = content.value
                .replace(/></g, '>\n<')
                .replace(/^\s+|\s+$/gm, '')
                .split('\n')
                .map((line, index, array) => {
                    let indent = 0;
                    for (let i = 0; i < index; i++) {
                        if (array[i].includes('<') && !array[i].includes('</') && !array[i].includes('/>')) {
                            indent++;
                        }
                        if (array[i].includes('</')) {
                            indent--;
                        }
                    }
                    if (line.includes('</')) indent--;
                    return '  '.repeat(Math.max(0, indent)) + line;
                })
                .join('\n');

            content.value = formatted;
            updateStats();
            updateLineNumbers();
            markUnsaved();
            showToast('Code formatted successfully!', 'success');
        } catch (error) {
            showToast('Error formatting code', 'error');
        }
    });

    // Validate HTML
    document.getElementById('validateCode').addEventListener('click', function () {
        const content = document.getElementById('content').value;
        const parser = new DOMParser();
        const doc = parser.parseFromString(content, 'text/html');
        const errors = doc.querySelectorAll('parsererror');

        if (errors.length === 0) {
            showToast('HTML is valid!', 'success');
        } else {
            showToast('HTML validation errors found', 'error');
        }
    });

    // Find & Replace functionality
    document.getElementById('findReplace').addEventListener('click', function () {
        const panel = document.getElementById('findReplacePanel');
        panel.classList.toggle('active');
        if (panel.classList.contains('active')) {
            document.getElementById('findInput').focus();
        }
    });

    document.getElementById('closeFindReplace').addEventListener('click', function () {
        document.getElementById('findReplacePanel').classList.remove('active');
    });

    document.getElementById('findNext').addEventListener('click', findNext);
    document.getElementById('findPrev').addEventListener('click', findPrev);
    document.getElementById('replaceOne').addEventListener('click', replaceOne);
    document.getElementById('replaceAll').addEventListener('click', replaceAll);

    function findNext() {
        const findText = document.getElementById('findInput').value;
        if (!findText) return;

        const content = document.getElementById('content');
        const text = content.value;
        const index = text.indexOf(findText, content.selectionEnd);

        if (index !== -1) {
            content.setSelectionRange(index, index + findText.length);
            content.focus();
        } else {
            showToast('No more matches found', 'info');
        }
    }

    function findPrev() {
        const findText = document.getElementById('findInput').value;
        if (!findText) return;

        const content = document.getElementById('content');
        const text = content.value;
        const index = text.lastIndexOf(findText, content.selectionStart - 1);

        if (index !== -1) {
            content.setSelectionRange(index, index + findText.length);
            content.focus();
        } else {
            showToast('No previous matches found', 'info');
        }
    }

    function replaceOne() {
        const findText = document.getElementById('findInput').value;
        const replaceText = document.getElementById('replaceInput').value;
        const content = document.getElementById('content');

        if (content.selectionStart !== content.selectionEnd) {
            const selectedText = content.value.substring(content.selectionStart, content.selectionEnd);
            if (selectedText === findText) {
                const before = content.value.substring(0, content.selectionStart);
                const after = content.value.substring(content.selectionEnd);
                content.value = before + replaceText + after;
                markUnsaved();
                updateStats();
            }
        }
    }

    function replaceAll() {
        const findText = document.getElementById('findInput').value;
        const replaceText = document.getElementById('replaceInput').value;
        const content = document.getElementById('content');

        if (findText) {
            const newValue = content.value.replaceAll(findText, replaceText);
            const count = (content.value.match(new RegExp(findText, 'g')) || []).length;
            content.value = newValue;
            markUnsaved();
            updateStats();
            showToast(`Replaced ${count} occurrences`, 'success');
        }
    }

    // Save file function
    function saveFile(isAutoSave = false) {
        const formData = new FormData(document.getElementById('editForm'));
        const saveBtn = document.getElementById('saveBtn');

        if (!isAutoSave) {
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            saveBtn.disabled = true;
        }

        fetch('/update-file', {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    markSaved();
                    if (!isAutoSave) {
                        showToast('File saved successfully!', 'success');
                    }
                } else {
                    showToast('Error: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showToast('An unexpected error occurred', 'error');
            })
            .finally(() => {
                if (!isAutoSave) {
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> Save Changes';
                    saveBtn.disabled = false;
                }
            });
    }

    // Handle form submission
    document.getElementById('editForm').addEventListener('submit', function (e) {
        e.preventDefault();
        saveFile();
    });

    // Show toast notification
    function showToast(message, type = 'info') {
        const toast = document.getElementById('statusMessage');
        const iconMap = {
            success: 'fas fa-check-circle',
            error: 'fas fa-exclamation-triangle',
            warning: 'fas fa-exclamation-circle',
            info: 'fas fa-info-circle'
        };

        toast.innerHTML = `
            <div class="toast toast-${type}">
                <i class="${iconMap[type]}"></i>
                <span>${message}</span>
            </div>
        `;
        toast.classList.add('show');

        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', function (e) {
        // Ctrl+S to save
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            saveFile();
        }

        // Ctrl+F to find
        if (e.ctrlKey && e.key === 'f') {
            e.preventDefault();
            document.getElementById('findReplace').click();
        }

        // Escape to close find panel
        if (e.key === 'Escape') {
            document.getElementById('findReplacePanel').classList.remove('active');
        }
    });

    // Warn before leaving with unsaved changes
    window.addEventListener('beforeunload', function (e) {
        if (isUnsaved) {
            e.preventDefault();
            e.returnValue = '';
        }
    });
</script>

<style>
    /* Reset body and html for full height */
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
    }

    /* Override base template styles */
    .container,
    .container-fluid {
        height: 100vh;
        max-width: none;
        padding: 0;
        margin: 0;
    }

    /* Modern Editor Styles */
    .editor-container {
        height: 100vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        flex-direction: column;
        background: #f8f9fa;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        z-index: 1000;
    }

    /* Header */
    .editor-header {
        background: #fff;
        border-bottom: 1px solid #e9ecef;
        padding: 1rem 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .editor-title {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .file-icon {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
    }

    .file-info h1 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #2d3748;
    }

    .file-path {
        color: #718096;
        font-size: 0.875rem;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    }

    .editor-actions {
        display: flex;
        gap: 0.5rem;
    }

    /* Content Area */
    .editor-content {
        flex: 1;
        display: flex;
        overflow: hidden;
    }

    /* Sidebar */
    .editor-sidebar {
        width: 280px;
        background: #fff;
        border-right: 1px solid #e9ecef;
        padding: 1.5rem;
        overflow-y: auto;
    }

    .sidebar-section {
        margin-bottom: 2rem;
    }

    .sidebar-section h3 {
        font-size: 1rem;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .tool-buttons {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .tool-btn {
        background: #f7fafc;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        padding: 0.75rem;
        text-align: left;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
    }

    .tool-btn:hover {
        background: #edf2f7;
        border-color: #cbd5e0;
    }

    .tool-btn:active {
        background: #e2e8f0;
    }

    /* File Stats */
    .file-stats {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem;
        background: #f7fafc;
        border-radius: 4px;
    }

    .stat-label {
        font-size: 0.875rem;
        color: #4a5568;
    }

    .stat-value {
        font-weight: 600;
        color: #2d3748;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    }

    /* Security Info */
    .security-badge {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: #f0fff4;
        color: #22543d;
        padding: 0.5rem 0.75rem;
        border-radius: 6px;
        border: 1px solid #c6f6d5;
        margin-bottom: 0.75rem;
        font-size: 0.875rem;
        font-weight: 500;
    }

    .security-text {
        font-size: 0.875rem;
        color: #4a5568;
        line-height: 1.4;
        margin: 0;
    }

    /* Main Editor Area */
    .editor-main {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: #fff;
    }

    /* Tabs */
    .editor-tabs {
        display: flex;
        background: #f7fafc;
        border-bottom: 1px solid #e2e8f0;
    }

    .tab {
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        color: #4a5568;
    }

    .tab:hover {
        background: #edf2f7;
        color: #2d3748;
    }

    .tab.active {
        background: #fff;
        color: #667eea;
        border-bottom-color: #667eea;
    }

    /* Workspace */
    .editor-workspace {
        flex: 1;
        display: flex;
        flex-direction: column;
        position: relative;
    }

    .editor-workspace.split-view {
        flex-direction: row;
    }

    .editor-panel {
        flex: 1;
        display: none;
        flex-direction: column;
    }

    .editor-panel.active {
        display: flex;
    }

    .editor-workspace.split-view .editor-panel.active {
        display: flex;
    }

    /* Find & Replace Panel */
    .find-replace-panel {
        background: #fff3cd;
        border-bottom: 1px solid #ffeaa7;
        padding: 1rem;
        display: none;
    }

    .find-replace-panel.active {
        display: block;
    }

    .find-replace-controls {
        display: flex;
        align-items: center;
        gap: 1rem;
        max-width: 800px;
    }

    .find-replace-controls .input-group {
        display: flex;
        gap: 0.5rem;
        flex: 1;
    }

    .find-replace-controls .form-control {
        padding: 0.375rem 0.75rem;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 0.875rem;
    }

    .find-buttons {
        display: flex;
        gap: 0.25rem;
    }

    /* Code Editor */
    .code-editor-wrapper {
        flex: 1;
        display: flex;
        position: relative;
        overflow: hidden;
    }

    .line-numbers {
        background: #f8f9fa;
        border-right: 1px solid #e9ecef;
        padding: 1rem 0.5rem;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.875rem;
        line-height: 1.5;
        color: #6c757d;
        user-select: none;
        min-width: 60px;
        text-align: right;
    }

    .line-number {
        height: 21px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
    }

    .code-editor {
        flex: 1;
        border: none;
        outline: none;
        padding: 1rem;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.875rem;
        line-height: 1.5;
        resize: none;
        background: #fff;
        color: #2d3748;
        tab-size: 2;
    }

    .code-editor:focus {
        background: #fff;
    }

    /* Preview */
    .preview-container {
        flex: 1;
        border-left: 1px solid #e9ecef;
    }

    .preview-container iframe {
        width: 100%;
        height: 100%;
        border: none;
        background: #fff;
    }

    /* Action Bar */
    .action-bar {
        background: #f8f9fa;
        border-top: 1px solid #e9ecef;
        padding: 1rem 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .save-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: #4a5568;
    }

    .action-right {
        display: flex;
        gap: 0.5rem;
    }

    /* Toast Notifications */
    .status-toast {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
    }

    .status-toast.show {
        opacity: 1;
        transform: translateX(0);
    }

    .toast {
        background: #fff;
        border-radius: 8px;
        padding: 1rem 1.5rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 0.75rem;
        min-width: 300px;
        border-left: 4px solid;
    }

    .toast-success {
        border-left-color: #48bb78;
        color: #22543d;
    }

    .toast-error {
        border-left-color: #f56565;
        color: #742a2a;
    }

    .toast-warning {
        border-left-color: #ed8936;
        color: #7b341e;
    }

    .toast-info {
        border-left-color: #4299e1;
        color: #2a4365;
    }

    /* Button Styles */
    .btn {
        padding: 0.5rem 1rem;
        border-radius: 6px;
        border: 1px solid transparent;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-primary {
        background: #667eea;
        color: white;
        border-color: #667eea;
    }

    .btn-primary:hover {
        background: #5a67d8;
        border-color: #5a67d8;
    }

    .btn-secondary {
        background: #718096;
        color: white;
        border-color: #718096;
    }

    .btn-secondary:hover {
        background: #4a5568;
        border-color: #4a5568;
    }

    .btn-success {
        background: #48bb78;
        color: white;
        border-color: #48bb78;
    }

    .btn-success:hover {
        background: #38a169;
        border-color: #38a169;
    }

    .btn-warning {
        background: #ed8936;
        color: white;
        border-color: #ed8936;
    }

    .btn-warning:hover {
        background: #dd6b20;
        border-color: #dd6b20;
    }

    .btn-outline-primary {
        background: transparent;
        color: #667eea;
        border-color: #667eea;
    }

    .btn-outline-primary:hover {
        background: #667eea;
        color: white;
    }

    .btn-outline-secondary {
        background: transparent;
        color: #718096;
        border-color: #718096;
    }

    .btn-outline-secondary:hover {
        background: #718096;
        color: white;
    }

    .btn-outline-success {
        background: transparent;
        color: #48bb78;
        border-color: #48bb78;
    }

    .btn-outline-success:hover {
        background: #48bb78;
        color: white;
    }

    .btn-outline-warning {
        background: transparent;
        color: #ed8936;
        border-color: #ed8936;
    }

    .btn-outline-warning:hover {
        background: #ed8936;
        color: white;
    }

    .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    .btn-sm {
        padding: 0.375rem 0.75rem;
        font-size: 0.8125rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .editor-sidebar {
            display: none;
        }

        .editor-header {
            flex-direction: column;
            gap: 1rem;
            align-items: stretch;
        }

        .editor-actions {
            justify-content: center;
        }

        .find-replace-controls {
            flex-direction: column;
            gap: 0.5rem;
        }

        .action-bar {
            flex-direction: column;
            gap: 1rem;
        }
    }

    /* Scrollbar Styling */
    .editor-sidebar::-webkit-scrollbar,
    .code-editor::-webkit-scrollbar {
        width: 8px;
    }

    .editor-sidebar::-webkit-scrollbar-track,
    .code-editor::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    .editor-sidebar::-webkit-scrollbar-thumb,
    .code-editor::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 4px;
    }

    .editor-sidebar::-webkit-scrollbar-thumb:hover,
    .code-editor::-webkit-scrollbar-thumb:hover {
        background: #a8a8a8;
    }

    /* Animation */
    .editor-container * {
        transition: all 0.2s ease;
    }

    /* Focus States */
    .code-editor:focus {
        box-shadow: inset 0 0 0 2px #667eea;
    }

    .find-replace-controls .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
    }
</style>
{% endblock %}